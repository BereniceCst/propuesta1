$nav-function-top-item-padding: 8px;
$nav-function-top-logo-width-sm: 28px;
$nav-function-top-logo-width-lg: 28px;
$nav-function-top-menu-item-bg: darken($nav-base-color, 15%);
$nav-function-top-menu-item-width-md: ( map-get($grid-breakpoints, md) - $nav-function-top-logo-width-sm ) / $nav-top-menu-count - 1;
$nav-function-top-menu-item-width-lg: ( map-get($grid-breakpoints, lg) - $nav-function-top-logo-width-lg ) / $nav-top-menu-count - 2;

.navigation-horizontal-prev,
.navigation-horizontal-next {
	display: none;
}

@include media-breakpoint-up($mobile-breakpoint) {

	.nav-function-top {

		.navigation-horizontal-prev,
		.navigation-horizontal-next {
			display: block;
			flex: 0 0 auto;
		}

		/* hide elements when nav-function-top */
		.hidden-nav-function-top {
			display: none !important;
		}


		&:not(.header-function-fixed) {
				
			#nff {
				position:relative;

				.onoffswitch-title {
					color: $settings-incompat-title;
				}
				.onoffswitch-title-desc {
					color: $settings-incompat-desc;
				}
				&:after {
					content: "DISABLED";
					display: block;
					position: absolute;
					background: $settings-incompat-bg;
					font-size: 10px;
					width: 65px;
					text-align: center;
					border: 1px solid $settings-incompat-border;
					height: 22px;
					line-height: 20px;
					border-radius: 10px;
					right: 13px;
					top: 26%;
					color:$fusion-900;
				}
			}

		}

		.page-header {
			margin-top: 0;

			.dropdown-icon-menu {
				display: none;
			}

			#search-field {
				margin:0 !important;
			}

			.logo {
				display: flex;
				width: auto;
				padding-left: 0;
				background: transparent;
				box-shadow: none;

				.logo-text {
					color: $base-text-color;
				}
			}
		}

		.page-wrapper {
			padding-left:0;

			.page-footer {
				width: 100%;
			}
		}

		.left-panel {
			display: flex;
			width: 100%;
			height: $nav-top-height;
			z-index: $depth-header - 1;
			overflow:hidden;
			padding: 0 0.625rem;

			position: relative;

			order: 2;		

			&:hover {
				overflow:visible;
			}

			.logo,
			.nav-filter,
			.info-card,
			.nav-title {
				display: none;
			}

			.primary-nav {
				overflow: hidden;

				flex: 1;
				display: flex;


				/* Make this scrollable when needed */
				overflow-x: auto;
				/* We don't want vertical scrolling */
				overflow-y: hidden;
				/* For WebKit implementations, provide inertia scrolling */
				-webkit-overflow-scrolling: touch;
				/* We don't want internal inline elements to wrap */
				white-space: nowrap;
				/* Crush the whitespace here */
				font-size: 0;

				/* Make an auto-hiding scroller for the 3 people using a IE */
				-ms-overflow-style: -ms-autohiding-scrollbar;
				/* Remove the default scrollbar for WebKit implementations */

				&::-webkit-scrollbar {
					display: none;
				}


				.nav-menu {
					margin:0;
					display: flex;

					> li {
						> a {
							> .badge:first-child {
								max-width: none;
								width: 25px !important;
								height: 25px !important;
								line-height: 16px !important;
								font-size: rem($fs-base) !important;
								display: block !important;
								margin: 0 auto 4px !important;

								// yes we do need the '!importants' here :(
							}

							& + ul {
								padding:0;

								ul {
									padding:0;
								}
							}

						}
					}

					li {

						position: static;

						a {
	    					font-size: rem($fs-base);

	    					&:before {
								content: none !important;
							}
						}

						ul {
							display: none !important;
							width: $nav-width - 2.1875rem; 
							position: absolute;
							box-shadow: 0 2px 3px rgba(0,0,0,0.15);

							li {
								width: 100%;
								position: relative;

								a {
									padding: 0.9375rem !important;
									width: 100%;
									max-height: none;
									box-shadow: none;

									.nav-link-text {
										display: block;

										> .dl-ref {
											margin-left:0;
											margin-right:5px;
											display: none;
										}
										> .#{$cust-icon-prefix}
										> [class*='fa-'] {
											margin-left: 6px;
										}
									}

								}

								&:hover {
									ul {
										display: block !important;
										left: 100%;
    									top: 0;

    									background: $nav-function-top-menu-item-bg;
									}
									&.top-menu-push-left {
										ul {
											right:100%;
											left:auto;
										}
									}
								}
							}
						}

						
					}

					> li {
						&:hover {
							> a {
								background: $nav-function-top-menu-item-bg;
								& + ul {
									display:block !important;
									background: $nav-function-top-menu-item-bg;

									box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);

									a {
										.collapse-sign {
											@include rotate(270);
										}
									}

									li {

										&:hover {
											> a {
												background: rgba( $primary-500, .9 );
												color:$white;
											}
										}
									} 
								}
							}						
						}

						&.active {
							> a {
								box-shadow: none;
							}
						}

						> a {
							padding: 0.9375rem !important;
							text-align: center;
							//height: $nav-top-height;
							//max-height: $nav-top-height;

							//display: block; /*override flex*/

							>.#{$cust-icon-prefix},
							>[class*='fa-'] {
								font-size: $nav-font-icon-size;
								margin: 0 !important;
								display: flex !important;					
								align-items: center;
								justify-content: left;
								color: inherit;
							}
							/*>[class*='fa-'] {
								font-size: 18px;
							}*/
							> .nav-link-text {
								//width: auto;
								max-width: $nav-function-top-menu-item-width-md;
								overflow: hidden;
								white-space: nowrap;
								text-overflow: ellipsis;
								line-height: normal;
								//font-size: rem($fs-nano);
								vertical-align: text-top;
								font-weight: bold;

								display: inline-block; /*override inline-flex*/
							}

							>.badge,
							>.badge.clear-badge {
								left: 53%;
							}

							>.collapse-sign {
								display: none
								//margin-left: 10px;
							}
						}

						> ul {

							padding:10px 0;
							height: auto !important; //counters the click issue

						}

						/*&:before {
							content: "";
							position: absolute;
							width: 1px;
							right: 0;
							top: 5px;
							bottom: 5px;
							background: -moz-linear-gradient(top, rgba(255, 255, 255, 0) 0%, rgba(255, 255, 255, 0.2) 50%, rgba(255, 255, 255, 0) 100%);
							background: -webkit-linear-gradient(top, rgba(255, 255, 255, 0) 0%, rgba(255, 255, 255, 0.2) 50%, rgba(255, 255, 255, 0) 100%);
							background: linear-gradient(to bottom, rgba(255, 255, 255, 0) 0%, rgba(255, 255, 255, 0.2) 50%, rgba(255, 255, 255, 0) 100%);
							z-index: 1;
						}*/

					}
				}


			}

			.nav-footer {
				display: none;
			}
		}


		&.nav-function-minify {

			.left-panel {
				//height: $nav-top-minify-height;

				/*.logo {
					width: auto !important;
					height: $nav-top-minify-height;
					padding: 0 1rem;			
				}*/

				.primary-nav {
					 
					.nav-menu {

						> li{

							> a {

								//min-width:$nav-top-minify-height;
								//height: $nav-top-minify-height;
								//padding-top:23% !important;

								> .nav-link-text {
									display: none;

								}

								> .badge {
									left:24px;
								}

								>.#{$cust-icon-prefix},
								>[class*='fa-'] {
									justify-content: center;
								}

							}

						}

					}
					
				}
			}

			/*.page-wrapper {
				padding-top:$nav-top-minify-height;
			}*/

		}

		&.mod-main-boxed {
			.left-panel {

				.primary-nav {
					.nav-menu:last-child,
					.nav-menu:only-child {
						> li:last-child,
						> li:nth-last-child(2),
						> li:nth-last-child(3) {
							&:hover {
								>a {
									& + ul {

										right:0;

									}
								}
							}
						}
					}
				}
			}
		}

		/* reorder */
		.page-header {
			order: 1;
		}
		.page-wrapper {
			display: flex;
			flex-direction: column;
		}
		.left-panel {
			order: 2;
		}
		#content {
			order: 3;
			align-items: stretch;
			flex: 1 1 auto;
		}
		.page-footer {
			order: 4;
			width: initial;

			position: initial;

			& + .page-footer-push {
				display: none;
			}
		}
 
	}
	
}

@include media-breakpoint-up(xl) {

	.nav-function-top {
		
		.left-panel {

			/*.logo {
				width: auto;
			}*/

			.primary-nav {

				.nav-menu {

					> li {
						> a {
							> .badge:first-child {
								max-width: none;
								width: 27px !important;
								height: 27px !important;
								line-height: 18px !important;
								margin: 0 auto 2px !important;
							}							
							>.#{$cust-icon-prefix},
							>[class*='fa-'],
							> img {
								font-size: 22px;
								margin: 3px auto 3px;
								height: 22px;
								display: block;
							}
							>[class*='fa-'] {
								font-size: rem(18px);
							}
							> .nav-link-text {
								//width:auto;
								max-width: $nav-function-top-menu-item-width-lg;
							}
						}
					}

					li {
						ul {
							 li {
							 	a {
							 		font-size: rem($fs-base);
							 	}
							 }
						}
					}

				}

			}	

		}
	}
}